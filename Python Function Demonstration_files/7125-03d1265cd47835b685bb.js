(self.webpackChunk_loomhq_web_client=self.webpackChunk_loomhq_web_client||[]).push([[7125],{39548:function(e,n,i){"use strict";i.d(n,{$p:function(){return l},mX:function(){return m},vG:function(){return u}});var a=i(40240);i(52069);var t=i(30313),o=i.n(t),r=i(5915),d=i.n(r),s=i(74302),c=i.n(s);let l=e=>(0,a.J$)().query({query:d(),variables:{id:e}}),m=e=>(0,a.J$)().mutate({mutation:o(),variables:{...e}}),u=()=>(0,a.J$)().mutate({mutation:c()})},27125:function(e,n,i){"use strict";i.d(n,{H:function(){return R}});var a=i(53422),t=i(72931),o=i(84466),r=i(49003),d=i(53061),s=i(65655),c=i(89600),l=i(9705),m=i(23555),u=i(79890),v=i(89895),p=i(14374),f=i(15596),k=i(39808),g=i(58461),h=i(2677),y=i(52069),S=i(39548);let{SignedOutEndOfVideoNudges:w,SignedOutAiEndOfVideoNudges:I,SignedOutEndOfVideoNudgesEmojiReactions:N,AnonDownloadVideoOnSharePage:V}=c.ASGSource,R=e=>{let{showErrorBar:n}=(0,s.gV)(),i=(0,v.v9)(e=>e.modals),{createEmojiReaction:c}=(0,l.S)(),{options:R}=i??{},{postComment:b,postRecordReplyComment:C}=(0,d.e)(e);return{anonShareGateAfterOauthLogin:async({provider:e,videoId:n})=>{let{data:i}=await (0,k.q3)(),a=new URL(window.location.href.split("?")[0]),{comment:d,emojiReaction:s,videoOwnerName:l,source:v,parentPostId:p,onboardingType:g}=R,S=i.me.checklist.complete_onboarding;if(d&&n&&b({comment:d,anonUserName:null,...p&&{parentPostId:p},videoId:n}),s&&n){let e=R?.currentVideoTime;c({type:s,time:1e3*e,videoId:n,placeUsed:m.aBB.sharePagePlayer})}if(!S){if("modal-onboarding"===g){a.searchParams.append("resume-anon-signup","true"),window.location.href=a.href;return}switch(v){case I:case w:(0,y.Ly)(u.YC,JSON.stringify({videoOwnerName:l,commentVideoId:n}));break;case N:(0,y.Ly)(u.Ct,JSON.stringify({videoOwnerName:l,emojiReactVideoId:n}))}if(v===V){window.location.href=`${r.OA}${r.n4}?redirect_to_share=${n}&start_download=true`;return}window.location.href=`${r.OA}${r.n4}`;return}S?(h.track(t.zgv,{provider:e,isSignUp:!1,source:o.Vc}),(0,f.v3)("button.click",{context:t.zgv,provider:e,isSignUp:!1,source:o.Vc}),v===V&&a.searchParams.append("start_download","true")):(a.searchParams.append("resume-anon-signup","true"),h.track(t.zgv,{provider:e,isSignUp:!0,source:o.Vc}),(0,f.v3)("button.click",{context:t.zgv,provider:e,isSignUp:!0,source:o.Vc})),window.location.href=a.href},highlightValueOfLoomAfterOauthLogin:()=>new Promise(e=>{let n=new URL(window.location.href);window.location.href=n.href,e()}),afterOauthLogin:async({videoId:e,addReplyId:i,password:r,videoCurrentTime:d,repliedToVideoId:s,provider:c})=>{let{data:l}=await (0,k.q3)(),m=new URL(window.location.href);try{await (0,S.mX)({replyVideoId:e,repliedToVideoId:s,videoCurrentTime:d,addReplyId:i})}catch(e){n({message:"There was an error.",severity:a.W9.ERROR}),p.error(e,{message:"Failed to create a Redis link for anonymous record a reply"},{feature:g.L0.SDKRecorder})}if(d&&m.searchParams.append("videoCurrentTime",d),l.me.checklist.complete_onboarding&&s&&i){C({recordedReplyVideoId:e,parentPostId:Number(i),password:r,videoId:s}),h.track(t.zgv,{provider:c,isSignUp:!1,source:o.IQ}),(0,f.v3)("button.click",{context:t.zgv,provider:c,isSignUp:!1,source:o.IQ});try{await (0,S.vG)()}catch(e){n({message:"There was an error.",severity:a.W9.ERROR}),p.error(e,{message:"Failed to transfer video ownership for anonymous record a reply"},{feature:g.L0.SDKRecorder})}}else e&&m.searchParams.append("replyVideoId",e),i&&m.searchParams.append("addReplyId",i),h.track(t.zgv,{provider:c,isSignUp:!0,source:o.IQ}),(0,f.v3)("button.click",{context:t.zgv,provider:c,isSignUp:!0,source:o.IQ});window.location.href=m.href}}}},53061:function(e,n,i){"use strict";i.d(n,{e:function(){return f}});var a=i(53422),t=i(72931),o=i(49003),r=i(65655),d=i(23555),s=i(14374),c=i(58461),l=i(2677),m=i(28668),u=i(34017);let v={},p=(0,m.Ps)`
    mutation UtilityCreateVideoComment($videoId: ID!, $content: String!, $timestamp: Int!, $mentions: VideoCommentContentMentionsInput, $password: String, $anonUserName: String, $parentPostId: Int) {
  createVideoComment(
    videoId: $videoId
    content: $content
    timestamp: $timestamp
    mentions: $mentions
    password: $password
    anonUserName: $anonUserName
    parentPostId: $parentPostId
  ) {
    avatar {
      name
      thumb
    }
    comment_post_id
    createdAt
    id
    content(withMentionMarkups: true)
    time_stamp
    user_id
    user_name
    anon_user_id
    children_comments {
      id
    }
  }
}
    `,f=e=>{let{showErrorBar:n}=(0,r.gV)(),i=(0,d.nn3)(e??""),[m,{loading:f}]=function(e){let n={...v};return u.D(p,n)}();return{postComment:async({anonUserName:e,comment:o,creationMethod:r,onCompleted:d,parentPostId:c,timestamp:u,videoId:v})=>{let p=!!c;await m({variables:{anonUserName:e,content:o,parentPostId:c,password:void 0,timestamp:u||Math.round(i?.currentTime??0),videoId:v},onCompleted:e=>{let n=e.createVideoComment;l.track(p?t.Rf6:t.jde,{comment_id:n?.id,video_id:v,creation_method:r,comment_length:n?.content?.length}),d?.(e)},onError:e=>{n({message:"Unable to create comment",severity:a.W9.ERROR}),s.error(e,{videoId:v,message:"Error creating comment"},{team:"create"})}})},postRecordReplyComment:async({parentPostId:e,creationMethod:r,password:d,recordedReplyVideoId:u,videoId:v})=>{let p=`${o.OA}/share/${u}`;await m({variables:{anonUserName:null,content:p,parentPostId:e,password:d,timestamp:Math.round(i?.currentTime??0),videoId:v},onCompleted:e=>{let n=e.createVideoComment;l.track(t.jde,{comment_id:n?.id,video_id:v,creation_method:r,comment_length:n?.content?.length})},onError:e=>{n({message:"Unable to create comment",severity:a.W9.ERROR}),s.error(e,{message:"Failed to create a comment for anonymous record a reply"},{feature:c.L0.CommentReactions})}})},isCreatingComment:f}}},9705:function(e,n,i){"use strict";i.d(n,{S:function(){return u}});var a=i(72931),t=i(14374),o=i(30497),r=i(2677),d=i(28668);let s=(0,d.Ps)`
    fragment ReactionFragment on PublicVideoReaction {
  id
  time
  user {
    id
    display_name
  }
  reaction
  extended_reaction
  anon_user_id
  anon_user_name
  locallyCreated @client
  localId @client
}
    `;var c=i(34017);let l={},m=(0,d.Ps)`
    mutation addVideoReaction($videoId: ID!, $time: Int!, $type: String!, $userName: String, $password: String, $reactionType: ReactionType) {
  addVideoReaction(
    videoId: $videoId
    time: $time
    type: $type
    userName: $userName
    password: $password
    reactionType: $reactionType
  ) {
    ...ReactionFragment
  }
}
    ${s}`,u=()=>{let[e]=function(e){let n={...l};return c.D(m,n)}();return{createEmojiReaction:({videoId:n,time:i,type:d,placeUsed:s=""})=>{let c=(0,o.uT)(d);e({variables:{videoId:n,time:i,type:d,reactionType:c},fetchPolicy:"no-cache",onCompleted:()=>{r.track(a.Sdx,{video_id:n,sentiment:d,place_used:s,freshPlayer:!0})},onError:e=>{t.warning(e,{message:"There was an error reacting to video"})}})}}}},30313:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateAnonRecordingCache"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyVideoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"repliedToVideoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"videoCurrentTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"addReplyId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAnonRecordingCache"},arguments:[{kind:"Argument",name:{kind:"Name",value:"replyVideoId"},value:{kind:"Variable",name:{kind:"Name",value:"replyVideoId"}}},{kind:"Argument",name:{kind:"Name",value:"repliedToVideoId"},value:{kind:"Variable",name:{kind:"Name",value:"repliedToVideoId"}}},{kind:"Argument",name:{kind:"Name",value:"videoCurrentTime"},value:{kind:"Variable",name:{kind:"Name",value:"videoCurrentTime"}}},{kind:"Argument",name:{kind:"Name",value:"addReplyId"},value:{kind:"Variable",name:{kind:"Name",value:"addReplyId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"createAnonRecordingCachePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:426}};n.loc.source={body:"mutation CreateAnonRecordingCache(\n  $replyVideoId: String!\n  $repliedToVideoId: String!\n  $videoCurrentTime: Float\n  $addReplyId: String\n) {\n  createAnonRecordingCache(\n    replyVideoId: $replyVideoId\n    repliedToVideoId: $repliedToVideoId\n    videoCurrentTime: $videoCurrentTime\n    addReplyId: $addReplyId\n  ) {\n    ... on createAnonRecordingCachePayload {\n      success\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.CreateAnonRecordingCache=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"CreateAnonRecordingCache")},5915:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetVideoInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"video"},name:{kind:"Name",value:"getVideo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RegularUserVideo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owner_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:155}};n.loc.source={body:"query GetVideoInfo($id: ID!) {\n  video: getVideo(id: $id) {\n    ... on RegularUserVideo {\n      id\n      owner_id\n      name\n      description\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.GetVideoInfo=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"GetVideoInfo")},74302:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateAnonRecordingOwnership"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAnonRecordingOwnership"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"updateAnonRecordingOwnershipPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:187}};n.loc.source={body:"mutation UpdateAnonRecordingOwnership {\n  updateAnonRecordingOwnership {\n    ... on updateAnonRecordingOwnershipPayload {\n      success\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.UpdateAnonRecordingOwnership=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=i[n]||new Set,r=new Set,d=new Set;for(o.forEach(function(e){d.add(e)});d.size>0;){var s=d;d=new Set,s.forEach(function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return r.forEach(function(n){var i=a(e,n);i&&t.definitions.push(i)}),t}(n,"UpdateAnonRecordingOwnership")}}]);
//# sourceMappingURL=https://www.loom.com/admin/sourcemaps/js/7125-03d1265cd47835b685bb.js.map