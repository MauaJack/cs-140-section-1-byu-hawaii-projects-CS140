(self.webpackChunk_loomhq_web_client=self.webpackChunk_loomhq_web_client||[]).push([[2973],{28729:function(e,n,i){"use strict";i.d(n,{Bp:function(){return d},Rf:function(){return l},Tr:function(){return t},cb:function(){return m},d0:function(){return a},d6:function(){return u},dS:function(){return s},e6:function(){return c},nL:function(){return r},p2:function(){return o}});let t="google",a="google-id-token",r="slack",o="slack-openid-connect",d="windows",l="auth0",s="apple",c="workos",u="atlassian",m=[l,c]},71341:function(e,n,i){"use strict";i.d(n,{BG:function(){return r},VN:function(){return o},Zx:function(){return d},wu:function(){return a}});var t=i(39419);let a=e=>({type:t.z9,err:e}),r=e=>({type:t.Q5,isFetching:e}),o=e=>({type:t.TY,err:e}),d=e=>({type:t.x9,err:e})},77961:function(e,n,i){"use strict";i.d(n,{C:function(){return o}});var t=i(40240),a=i(31245),r=i.n(a);let o=async(e,n)=>{let i=(0,t.J$)(),{data:{acceptInviteLinkInvitation:a}}=await i.mutate({mutation:r(),variables:{inviteLinkId:e,isNewUser:n}});return a}},23217:function(e,n,i){"use strict";i.d(n,{ZJ:function(){return q},b2:function(){return G},fi:function(){return C},l$:function(){return R},x4:function(){return x}});var t=i(93185),a=i(49003),r=i(80396),o=i(44314),d=i(40240),l=i(68213),s=i(87480),c=i(14374),u=i(71907),m=i(7910),v=i(39808),k=i(71022),f=i(94713),p=i(21722),y=i(28729),h=i(99532),g=i(54581),S=i(58461),N=i(85578),w=i(71341),b=i(86297),I=i.n(b),E=i(83380),F=i.n(E),L=i(2677),_=i(80935),T=i(77961),U=i(95180),D=i(27584);i(16479);var A=i(16585);let{hex:P}=f;function O(e){return"object"==typeof e&&null!==e&&"created"in e&&"boolean"==typeof e.created&&"error"in e&&("string"==typeof e.error||null===e.error)&&"loginSuccess"in e&&"boolean"==typeof e.loginSuccess&&"type"in e&&"string"==typeof e.type&&"userRole"in e&&"string"==typeof e.userRole&&(!("redirect_after"in e)||"string"==typeof e.redirect_after)}let V=e=>{(0,d.J$)().mutate({mutation:F(),variables:{name:N.BR.SIGNUP_LOCATION,value:e}}).then(({data:e})=>{let{success:n}=e;return n})},$=()=>{try{(0,s.k)().then(e=>{V(e.country)}).catch(e=>{c.warning(e,{message:"Failed to get update location",team:S.SZ.Billing})})}catch(e){c.warning(e,{message:"Failed to get fetch location",team:S.SZ.Billing})}},Z=async e=>{let n;let i=e.deeplink_uri;if(e.invalidLogin||i&&(0,U.Z)(i)){(0,v.dq)();return}let t=(0,m.jS)("redirect_after"),r=(0,m.jS)("orgToken")||(0,m.jS)("orgTokenForMemberPreview"),o=(0,m.jS)("invite_link_id"),d=(0,m.jS)("companyID"),l=(0,m.jS)("redirect");if(d&&P(d)&&l&&!(0,U.Z)(l)){window.location.reload();return}if(e.loginSuccess){if(e.created){n=new URL(a.OA+a.n4);try{await $()}catch(e){c.warning(e,{message:"unable to update user location",team:S.SZ.Billing})}}else if(t){let e=window.decodeURIComponent(t);(0,U.Z)(e)&&(e="/"),n=new URL(e,a.OA)}else if(e.redirect_after){let i=window.decodeURIComponent(e.redirect_after);(0,U.Z)(i)&&(i="/"),n=new URL(i,a.OA)}else n=new URL(a.OA+a.wE)}else n=new URL(a.OA+a.DV);if(null!=e.error&&n.searchParams.set("oauth_error",e.error),r)try{await (0,D.D2)(r)}catch{A.error("TeamInvite: Unable to accept invite after oauth")}else if(o)try{let{success:n,__typename:i}=await (0,T.C)(o,e.created);"GenericError"!==i&&n||c.warning(Error("InviteLink: Unable to process link after oauth authorization"),{invite_link_id:o,accept_failure_reason:i})}catch(e){c.warning(e`InviteLink: Unable to process link after oauth authorization`,{invite_link_id:o,error_message:e.message})}e.loginSuccess?_.Rf(()=>{let e=n.toString();i&&window.location.replace(i),window.location.href=e}):window.location.href=n.toString()},x=(e,n)=>{let{query:i}=r.parse(window.location.search||"",!0),t={pathname:a.ym,query:{app_source:p._v,...i}},d=r.format(t);return(0,o.Z)(d,{method:"POST",headers:{[h.Jd]:g._R},body:JSON.stringify({email:e,password:n,sstSupported:!0})})},C=(e,n={},i=Z)=>{let r=new URL(`${a.OA}/api/auth/${e}`),o=new URLSearchParams(r.search);Object.keys(n).map(e=>o.set(e,n[e]));let d=(0,m.jS)("app_source")||p._v;o.set("app_source",d),o.set("sstSupported","true"),L.ready(()=>{let{anonID:e}=L.getAnalyticsIds();o.set("anon_id",e),L.amplitudeLoaded()&&o.set("device_id",window.amplitude.getInstance().options.deviceId);let n=`${r.toString()}?${o.toString()}`,d=window.open(n,`loom_${(0,k.Z)()}_popup`,"width=600,height=800"),s=e=>{let n;try{let r=new URL(e.origin)?.origin;if(["https://js.stripe.com"].includes(r))return;if("string"==typeof e.data)n=(0,l.FL)(e.data,{type:"default-oauth-type"},O),"default-oauth-type"===n.type&&c.warning(Error("Malformed auth data, falling back to default oauth type"),{event:e,team:S.SZ.Outreach}),(r!==a.OA||n.type!==t.D)&&(n.invalidLogin=!0),window.removeEventListener("message",s),d?.close(),i(n);else throw Error("Malformed oauth data")}catch(n){c.error("Auth Error",{message:n.message,origin:e.origin,team:S.SZ.Outreach,event:e},{feature:S.L0.Authentication});return}};window.addEventListener("message",s)})},G=()=>{u.h.dispatch((0,w.wu)(null)),u.h.dispatch((0,w.Zx)(null)),u.h.dispatch((0,w.VN)(null))},R=e=>(0,d.J$)().query({query:I(),variables:{email:e},fetchPolicy:"no-cache"}),q=(e,n)=>e!==y.e6&&(!n||!!(0,U.Z)(n)||e.includes("desktop"))},95180:function(e,n,i){"use strict";var t=i(49003),a=i(17563);n.Z=e=>!!(e&&!e.startsWith(t.OA)&&e!==t.Gz&&!("/"==e[0]&&(1==e.length||"/"!=e[1]&&"\\"!=e[1]))&&!e.startsWith(a.t4)&&!e.startsWith(t.MB))},87480:function(e,n,i){"use strict";i.d(n,{k:function(){return a}});var t=i(44314);async function a(){let e=await (0,t.Z)("https://location.loom.com",{method:"GET"});return{country:e.headers.get("x-loom-country")??"",city:e.headers.get("x-loom-city")??"",postalCode:e.headers.get("x-loom-postal-code")??"",latitude:parseFloat(e.headers.get("x-loom-latitude")??""),longitude:parseFloat(e.headers.get("x-loom-longitude")??"")}}},86297:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetPrimaryAuthTypeForEmail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"response"},name:{kind:"Name",value:"getPrimaryAuthTypeForEmail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GetPrimaryAuthTypePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:228}};n.loc.source={body:"query GetPrimaryAuthTypeForEmail($email: String!) {\n  response: getPrimaryAuthTypeForEmail(email: $email) {\n    __typename\n    ... on GetPrimaryAuthTypePayload {\n      authType\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.GetPrimaryAuthTypeForEmail=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"GetPrimaryAuthTypeForEmail")},83380:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateUserProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BasicScalar"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"updateUserProperty"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UpdatedPersonProperty"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updated"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:254}};n.loc.source={body:"mutation UpdateUserProperty($name: String!, $value: BasicScalar!) {\n  result: updateUserProperty(name: $name, value: $value) {\n    ... on UpdatedPersonProperty {\n      property {\n        name\n        value\n      }\n      created\n      updated\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.UpdateUserProperty=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"UpdateUserProperty")},31245:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AcceptInviteLinkInvitation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acceptInviteLinkInvitation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"inviteLinkId"},value:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}}},{kind:"Argument",name:{kind:"Name",value:"isNewUser"},value:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AcceptInviteLinkInvitationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GenericError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkDisabledError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkNotFoundError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkWorkspaceSsoError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:555}};n.loc.source={body:"mutation AcceptInviteLinkInvitation($inviteLinkId: ID!, $isNewUser: Boolean!) {\n  acceptInviteLinkInvitation(\n    inviteLinkId: $inviteLinkId\n    isNewUser: $isNewUser\n  ) {\n    __typename\n    ... on AcceptInviteLinkInvitationPayload {\n      success\n      redirect\n    }\n    ... on GenericError {\n      message\n      error\n    }\n    ... on InviteLinkDisabledError {\n      success\n      redirect\n    }\n    ... on InviteLinkNotFoundError {\n      success\n      redirect\n    }\n    ... on InviteLinkWorkspaceSsoError {\n      success\n      redirect\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.AcceptInviteLinkInvitation=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"AcceptInviteLinkInvitation")}}]);
//# sourceMappingURL=https://www.loom.com/admin/sourcemaps/js/2973-4b1786604a237a6815ed.js.map